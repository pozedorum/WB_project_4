
# Распределённая CLI-утилита (grep)

Распределенная версия утилиты `grep` с поддержкой параллельной обработки файлов с использованием горутин и каналов.

## Особенности

- **Параллельная обработка**: Файлы разбиваются на чанки и обрабатываются несколькими воркерами одновременно
- **Распределенный режим**: Поддержка работы с несколькими параллельными обработчиками (`-Q` флаг c аргументом сколько воркеров)
- **Кворум**: Результаты объединяются после успешной обработки всех чанков
- **Совместимость**: Поддерживает основные флаги стандартного grep

## Установка и сборка

```bash
# Клонирование репозитория
git clone <repository-url>
cd WB_project_4/task2

# Сборка проекта
make mygrep
```

## Использование

### Базовое использование (без параллелизма)
```bash
./mygrep pattern filename
```

### Распределенный режим с параллельными воркерами
```bash
./mygrep -Q 4 pattern filename                    # 4 воркера
./mygrep -Q 2 -i test tests/test_large_file.txt    # 2 воркера, регистронезависимо
```

### Доступные флаги
- `-Q N`: Количество параллельных воркеров (обязателен для распределенного режима)
- `-i`: Регистронезависимый поиск
- `-v`: Инвертировать поиск (выводить строки, НЕ содержащие паттерн)
- `-n`: Показывать номера строк
- `-c`: Только подсчет количества совпадений

## Примеры

```bash
# Простой поиск
./mygrep err ./internal/grep/grep.go

# Параллельный поиск с 4 воркерами
./mygrep -Q 4 "func" ./**/*.go

```

## Структура проекта

```
task2/
├── main.go                 # Основная точка входа
├── internal/
│   ├── concurrency/        # Распределенная обработка
│   │   ├── master.go       # Мастер-координатор
│   │   └── worker.go       # Воркеры
│   ├── chunks/             # Разбиение файлов на чанки
│   ├── grep/               # Логика поиска
│   ├── options/            # Парсинг флагов
│   └── models/             # Структуры данных
├── tests/                  # Тестовые файлы
│   ├── test1.txt
│   └── test_large_file.txt
└── Makefile
```

## Тестирование

### Сравнение с оригинальным grep
```bash
make test
```

Этот тест:
1. Запускает вашу утилиту на тестовых файлах
2. Запускает стандартный grep с теми же параметрами
3. Сравнивает результаты через `diff`

### Ручное тестирование
```bash
# Тест на маленьком файле
./mygrep pattern tests/test1.txt
grep pattern tests/test1.txt

# Тест на большом файле с параллельной обработкой
./mygrep -Q 4 pattern tests/test_large_file.txt
grep test tests/test_large_file.txt
```

## Ограничения

- Максимальный размер чанка: 10MB
- Поддерживается только операция grep (cut/sort не реализованы, но оставлена возможность доделать)
- Работает только с локальными файлами

